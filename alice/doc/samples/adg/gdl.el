(defvar gdl-syntax-table
  (let ((table (make-syntax-table)))
    (modify-syntax-entry ?{ "(}" table)
    (modify-syntax-entry ?} "){" table)
    table
  )
)

(defvar gdl-keywords
  (list
    (list "//[^\\\n]*" 0 'font-lock-comment-face 'keep)
    (list "\\\"[^\\\"\\\n]*\\\""    0 'font-lock-string-face t)
    (list "graph:\\|node:\\|region:" 0 'font-lock-function-name-face t)
    (list "leftbentnearedge:\\|rightbentnearedge:\\|rightnearedge:\\|leftnearedge:\\|bentnearedge:\\|nearedge:\\|backedge:\\|edge:" 0 'font-lock-function-name-face t)
    (list "white\\|blue\\|\\bred\\b\\|green\\|yellow\\|magenta\\|cyan\\|black" 0 'font-lock-variable-name-face 'keep)
    (list "pink\\|orange\\|gold\\|lilac\\|turquoise\\|aquamarine" 0 'font-lock-variable-name-face 'keep)
    (list "darkgray\\|darkgrey\\|darkblue\\|darkred\\|darkgreen\\|darkyellow\\|darkmagenta\\|darkcyan" 0 'font-lock-variable-name-face 'keep)
    (list "lightgray\\|lightgrey\\|lightblue\\|lightred\\|lightgreen\\|lightyellow\\|lightmagenta\\|lightcyan" 0 'font-lock-variable-name-face 'keep)
    (list "colorentry +[0-9]+" 0 'font-lock-variable-name-face 'keep)
    (list "foldnode\\.[a-z]+" 0 'font-lock-variable-name-face 'keep)
    (list "foldedge\\.[a-z]+" 0 'font-lock-variable-name-face 'keep)
    (list "node\\.[a-z]+" 0 'font-lock-variable-name-face 'keep)
    (list "edge\\.[a-z]+" 0 'font-lock-variable-name-face 'keep)
    (list "boxed\\|unfolded\\|folded\\|wrapped\\|exclusive\\|clustered" 0 'font-lock-keyword-face 'keep)
    (list "box\\|circle\\|rhomboid\\|rhomb\\|hexagon\\|triangle\\|ellipse" 0 'font-lock-keyword-face 'keep)
    (list "trapeze\\|uptrapeze\\|trapezoid\\|uptrapezoid\\|lparallelogram\\|rparallelogram" 0 'font-lock-keyword-face 'keep)
    (list "\\btree\\b\\|\\bdfs\\b\\|\\bnormal\\b\\|forcedir" 0 'font-lock-keyword-face 'keep)
    (list "maxdepth\\|maxdepthslow\\|maxindegree\\|maxoutdegree\\|maxdegree" 0 'font-lock-keyword-face 'keep)
    (list "mindepth\\|mindepthslow\\|minindegree\\|minoutdegree\\|mindegree" 0 'font-lock-keyword-face 'keep)
    (list "free\\|fixed" 0 'font-lock-keyword-face 'keep)
    (list "\\bline\\b\\|\\bnone\\b" 0 'font-lock-keyword-face 'keep)
    (list "solid\\|continuous\\|dashed\\|dotted\\|double\\|triple\\|invisible" 0 'font-lock-keyword-face 'keep)
    (list "polar\\|polcircular\\|circular\\|orthogonal" 0 'font-lock-keyword-face 'keep)
    (list "lefttoright\\|righttoleft\\|toptobottom\\|bottomtotop" 0 'font-lock-keyword-face 'keep)
    (list "left_to_right\\|right_to_left\\|top_to_bottom\\|bottom_to_top" 0 'font-lock-keyword-face 'keep)
    (list "left_justify\\|right_justify\\|center\\|top\\|bottom" 0 'font-lock-keyword-face 'keep)
    (list "maxspect\\|maxlevel" 0 'font-lock-keyword-face 'keep)
    (list "[0-9]+\\.[0-9]+" 0 'font-lock-constant-face 'keep)
    (list "[0-9]+" 0 'font-lock-constant-face 'keep)
    (list "\\byes\\b\\|\\bno\\b" 0 'font-lock-constant-face 'keep)
  )
)

(defun gdl-mode ()
  "Major mode for editing GDL files"
  (interactive)
  (kill-all-local-variables)
  (setq major-mode 'gdl-mode mode-name  "GDL")
  (setq font-lock-syntax-table  gdl-syntax-table)
  (set-syntax-table gdl-syntax-table)
  (setq font-lock-keywords      gdl-keywords)
  (font-lock-add-keywords 'gdl-mode gdl-keywords 'set)
  (turn-on-font-lock)
)

(setq auto-mode-alist
  (cons  '("\\.gdl\\|\\.vcg" . gdl-mode)
         auto-mode-alist)
)
